
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sorting and Filtering Data &#8212; quasarscan 3.0.1 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Plotting Your Data" href="plottingdata.html" />
    <link rel="prev" title="Creating Sightlines in yt" href="creatingsightlines.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="sorting-and-filtering-data">
<h1>Sorting and Filtering Data<a class="headerlink" href="#sorting-and-filtering-data" title="Permalink to this headline">¶</a></h1>
<p>After we have run <code class="docutils literal notranslate"><span class="pre">run_sightlines</span></code> and collected all our data, we need to be able to see the results! QUASARSCAN can automatically read all the data stored in your <code class="docutils literal notranslate"><span class="pre">quasarscan_data</span></code> folder and present it in a variety of useful ways in 2, 3, 4, or 5 dimensions, either for publishable papers or just data exploration. In addition to plotting the sightlines from the simulation, it is possible to load observational sightline data, or explore metadata as created by <code class="docutils literal notranslate"><span class="pre">create_metadata</span></code>, to determine which simulations are worth analyzing in more detail.</p>
<p>First, we will discuss filtering your data so that plots can be maximally useful and only show what is needed to analyze a particular point.</p>
<div class="section" id="loading-data">
<h2>Loading Data<a class="headerlink" href="#loading-data" title="Permalink to this headline">¶</a></h2>
<p>To begin analysis, the first step is to instantiate a <code class="docutils literal notranslate"><span class="pre">MultiQuasarSpherePlotter</span></code> object. This will automatically load all of the sightline data in your <code class="docutils literal notranslate"><span class="pre">quasarscan_data</span></code> folder.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mq</span> <span class="o">=</span> <span class="n">quasarscan</span><span class="o">.</span><span class="n">create_mq</span><span class="p">(</span><span class="n">loadsim</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span><span class="n">loadobs</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="n">loadempty</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">average</span> <span class="o">=</span> <span class="s1">&#39;median&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">loadsim</span></code> and <code class="docutils literal notranslate"><span class="pre">loadobs</span></code> refer to which simulations/observations to load (specified by giving any part of the simulation/observation’s <code class="docutils literal notranslate"><span class="pre">fullname</span></code>), <code class="docutils literal notranslate"><span class="pre">loadempty</span></code> refers again to simulations, but loads simulations from their existing metadata, rather than because it has existing sightlines (thus it’s “empty”). <code class="docutils literal notranslate"><span class="pre">average</span></code> refers to the default averaging functon. The options are:</p>
<ul class="simple">
<li><p>“mean”</p></li>
<li><p>“median” (if “median” is given, one can also give either an integer percentile which represents the size of errorbars, default is 25)</p></li>
</ul>
<p>The averaging function can also be specified during the <code class="docutils literal notranslate"><span class="pre">plot</span></code> step.</p>
</div>
<div class="section" id="constraining-data">
<h2>Constraining Data<a class="headerlink" href="#constraining-data" title="Permalink to this headline">¶</a></h2>
<p>While the software by default will load all saved simulations, it is best to constrain and sort by different quantities. For example, we can restrict to low/high redshift, low/high stellar mass, low/high SFR, etc. This is implemented in two ways. First, we can restrict the whole list and just cut out most of the data that doesn’t fit our specifications. Second, we can sort the remaining data by another variable and put it into several bins. We will call each galaxy snapshot’s “collection of lines” a QuasarSphere.</p>
<p>First, you can always see the current loaded QuasarSpheres and metadata. For example, to see all the star formation rates and stellar masses, run:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mq</span><span class="o">.</span><span class="n">list_all_quasar_spheres</span><span class="p">(</span><span class="s1">&#39;SFR&#39;</span><span class="p">,</span><span class="s1">&#39;Mstar&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To constrain the data, use the code below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mq</span><span class="o">.</span><span class="n">constrain_current_quasar_array</span><span class="p">(</span><span class="n">constrain_criteria</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">constrain_criteria</span></code> refers to the metadata in question. For example, to restrict to redshifts between 0.5 and 1.0, use the code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mq</span> <span class="o">=</span> <span class="n">quasarscan</span><span class="o">.</span><span class="n">create_mq</span><span class="p">()</span>
<span class="n">mq</span><span class="o">.</span><span class="n">constrain_current_quasar_array</span><span class="p">(</span><span class="s1">&#39;redshift&#39;</span><span class="p">,[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
</pre></div>
</div>
<p>You can also restrict by certain kinds of simulations or simulation number. To do this, run with a list of acceptable string values. For example, to restrict to the VELA simulation, number 1,2, and 3, we can run:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mq</span> <span class="o">=</span> <span class="n">quasarscan</span><span class="o">.</span><span class="n">create_mq</span><span class="p">()</span>
<span class="n">mq</span><span class="o">.</span><span class="n">constrain_current_quasar_array</span><span class="p">(</span><span class="s1">&#39;simname&#39;</span><span class="p">,[</span><span class="s1">&#39;VELA&#39;</span><span class="p">])</span>
<span class="n">mq</span><span class="o">.</span><span class="n">constrain_current_quasar_array</span><span class="p">(</span><span class="s1">&#39;simnum&#39;</span><span class="p">,[</span><span class="s1">&#39;01&#39;</span><span class="p">,</span><span class="s1">&#39;02&#39;</span><span class="p">,</span><span class="s1">&#39;03&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>After doing this, you can always reset to the full list by running</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mq</span><span class="o">.</span><span class="n">reset_current_quasar_array</span><span class="p">()</span>
</pre></div>
</div>
<p>The full list of arguments arguments for <code class="docutils literal notranslate"><span class="pre">constrain_current_quasar_array</span></code> is below.</p>
<ul class="simple">
<li><p>constrain_criteria: <code class="docutils literal notranslate"><span class="pre">string</span></code>. Can refer to snapshot param (<code class="docutils literal notranslate"><span class="pre">Rvir</span></code>, <code class="docutils literal notranslate"><span class="pre">Mvir</span></code>, <code class="docutils literal notranslate"><span class="pre">redshift</span></code>, <code class="docutils literal notranslate"><span class="pre">sfr</span></code> etc.) or stringparam (<code class="docutils literal notranslate"><span class="pre">simname</span></code>, <code class="docutils literal notranslate"><span class="pre">simnum</span></code>, <code class="docutils literal notranslate"><span class="pre">version</span></code>, etc.)</p></li>
<li><p>bins=None: <code class="docutils literal notranslate"><span class="pre">list</span></code> of either two numbers, which are low and high edges of bin, if <code class="docutils literal notranslate"><span class="pre">constrain_criteria</span></code> is a snapshot param, or multiple accepted strings, if <code class="docutils literal notranslate"><span class="pre">constrain_criteria</span></code> is a stringparam.</p></li>
<li><p>qtype=’all’: <code class="docutils literal notranslate"><span class="pre">string</span></code> By default, sort all observations and empty QuasarSpheres (see “Advanced Plotting Techniques”) alongside simulations. Can change to ‘sim’, ‘obs’, or ‘empty’ to only effect those lists. If <code class="docutils literal notranslate"><span class="pre">constrain_criteria</span></code> is a stingparam, this defaults to ‘sim’.</p></li>
<li><p>at_end=False: <code class="docutils literal notranslate"><span class="pre">boolean</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code> If False, use the current value of the snapshot param. If <code class="docutils literal notranslate"><span class="pre">float</span></code> between 0 and 1, use the value of this simulation at expansion parameter a = <code class="docutils literal notranslate"><span class="pre">at_end</span></code>. Simulations which do not run to that time are excluded.</p></li>
<li><p>exclude=False: <code class="docutils literal notranslate"><span class="pre">boolean</span></code>. If True, restrict to all values outside of bin, instead of inside. This is most useful to exclude a single simulation with a stringparam.</p></li>
<li><p>split_even=False: <code class="docutils literal notranslate"><span class="pre">boolean</span></code> or <code class="docutils literal notranslate"><span class="pre">string</span></code>. If False, use value in <code class="docutils literal notranslate"><span class="pre">bins</span></code>. If <code class="docutils literal notranslate"><span class="pre">split_even='high'</span></code>, create a bin of all simulations with <code class="docutils literal notranslate"><span class="pre">constrain_criteria</span></code> higher than the median and sort using that. If <code class="docutils literal notranslate"><span class="pre">split_even='low'</span></code>, create a bin of all simulations with <code class="docutils literal notranslate"><span class="pre">constrain_criteria</span></code> lower than the median and sort using that.</p></li>
<li><p>set_main_array=False: <code class="docutils literal notranslate"><span class="pre">boolean</span></code>. If True, restrict the main array with this call, not just the current array. After running this, <code class="docutils literal notranslate"><span class="pre">reset_current_quasar_array</span></code> will no longer reset to before this line.</p></li>
</ul>
</div>
<div class="section" id="sorting-data">
<h2>Sorting Data<a class="headerlink" href="#sorting-data" title="Permalink to this headline">¶</a></h2>
<p>After appropriately restricting your data, you will probably want to keep track of multiple bins of galaxy snapshots at once. This function is run in a very similar way, via a <code class="docutils literal notranslate"><span class="pre">constrain_criteria</span></code> such as mass, redshift, or SFR. In this case, one can give multiple bins. It returns a tuple of (0) a string describing the bins (which will be used as their label in the graphs below), (1) a list of bin edges, and (2) the list of arrays of QuasarSpheres. This is conventionally referred to as “lq” for “labels,bins,QuasarSpheres”. The below will sort your data into three bins, galaxy snapshots with</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lq</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">sort_by</span><span class="p">(</span><span class="s1">&#39;sfr&#39;</span><span class="p">,[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">10.0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>
</pre></div>
</div>
<p>Unlike <code class="docutils literal notranslate"><span class="pre">constrain_current_quasar_array</span></code>, <code class="docutils literal notranslate"><span class="pre">sort_by</span></code> does not effect the internal list of quasarspheres, it just distributes the existing list into multiple sublists and returns them. Note that any galaxies which do not fit in any bin, or have a <code class="docutils literal notranslate"><span class="pre">nan</span></code> for their <code class="docutils literal notranslate"><span class="pre">criteria</span></code> are simply not returned.</p>
<p>One useful keyword argument of <code class="docutils literal notranslate"><span class="pre">sort_by</span></code> is <code class="docutils literal notranslate"><span class="pre">split_even=n</span></code>. This will split the list into <code class="docutils literal notranslate"><span class="pre">n</span></code> bins of equal size, without needing to specify the bins in advance. The bin edges will be thus somewhat arbitrary, but each bin all have a meaningful amount of data and will be useful for distinguishing low, medium, and high mass galaxies (for example):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lq</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">sort_by</span><span class="p">(</span><span class="s1">&#39;Mstar&#39;</span><span class="p">,</span><span class="n">split_even</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>The full list of arguments arguments for <code class="docutils literal notranslate"><span class="pre">sort_by</span></code> is below.</p>
<ul class="simple">
<li><p>criteria:<code class="docutils literal notranslate"><span class="pre">string</span></code>. Can refer to snapshot param (<code class="docutils literal notranslate"><span class="pre">Rvir</span></code>, <code class="docutils literal notranslate"><span class="pre">Mvir</span></code>, <code class="docutils literal notranslate"><span class="pre">redshift</span></code>, <code class="docutils literal notranslate"><span class="pre">sfr</span></code> etc.) or stringparam (<code class="docutils literal notranslate"><span class="pre">simname</span></code>, <code class="docutils literal notranslate"><span class="pre">simnum</span></code>, <code class="docutils literal notranslate"><span class="pre">version</span></code>, etc.)</p></li>
<li><p>bins=[0,np.inf]:<code class="docutils literal notranslate"><span class="pre">list</span></code> edges of bins, if snapshot param, or list of accepted bins, if stringparam. The default arg just checks that the value in question exists but does not filter for any value.</p></li>
<li><p>at_end=False: <code class="docutils literal notranslate"><span class="pre">boolean</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code> If False, use the current value of the snapshot param. If <code class="docutils literal notranslate"><span class="pre">float</span></code> between 0 and 1, use the value of this simulation at expansion parameter a = <code class="docutils literal notranslate"><span class="pre">at_end</span></code>. Simulations which do not run to that time are not returned.</p></li>
<li><p>split_even=False: <code class="docutils literal notranslate"><span class="pre">boolean</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code>. If False, use values in <code class="docutils literal notranslate"><span class="pre">bins</span></code>. If <code class="docutils literal notranslate"><span class="pre">int</span></code>, sort the simulation data into that many equal-sized bins</p></li>
<li><p>reverse=False: <code class="docutils literal notranslate"><span class="pre">boolean</span></code>, if <code class="docutils literal notranslate"><span class="pre">True</span></code> return the bins in reverse order (by default, they are returned low to high)</p></li>
<li><p>sort_w_qtype=’sim’: <code class="docutils literal notranslate"><span class="pre">string</span></code>, only used if <code class="docutils literal notranslate"><span class="pre">split_even</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>. Split by putting <code class="docutils literal notranslate"><span class="pre">qtype=('sim',</span> <span class="pre">'obs',</span> <span class="pre">or</span> <span class="pre">'empty')</span></code> into equal sized bins.</p></li>
</ul>
<p>To use the bins, we will keep this <code class="docutils literal notranslate"><span class="pre">lq</span></code> object and bring plug it into a plot function.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">quasarscan</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="creatingsightlines.html">Creating Sightlines in yt</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Sorting and Filtering Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#loading-data">Loading Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#constraining-data">Constraining Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sorting-data">Sorting Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plottingdata.html">Plotting Your Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="advancedplotting.html">More Advanced Plotting</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="creatingsightlines.html" title="previous chapter">Creating Sightlines in yt</a></li>
      <li>Next: <a href="plottingdata.html" title="next chapter">Plotting Your Data</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Clayton Strawn.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.5.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/sortingfiltering.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>